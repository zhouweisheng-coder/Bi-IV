## 第五章 CTR预估算法与基于流行度的推荐

[TOC]



### Thinking1 在CTR点击率预估中，使用GBDT+LR的原理是什么？能简要说明GBDT和LR在CTR预估中的作用（10point）

* 通过GBDT将**特征进行组合**，然后传入给线性分类器，LR对GBDT产生的输入数据进行分类。GBDT的思想使其具有天然优势，可以发现多种有区分性的特征及特征组合。决策树的路径可以直接作为LR输入特征使用，省去了人工寻找特征、特征组合的步骤。

  <img src="C:\Users\Zhou\AppData\Roaming\Typora\typora-user-images\image-20200921161430899.png" alt="image-20200921161430899" style="zoom: 50%;" />

  如果一个实例，选择了第一棵决策树的第2个叶子节点。同时，选择第2棵子树的第1个叶子节点。那么前3个叶子节点中，第2位设置为1，后2个叶子节点中，第1位设置为1。concatenate所有特征向量，得到[0,1,0,1,0]，可以直接作为LR的输入

* 作用：点击率预估涉及到的样本一般是上亿级别的，样本量庞大，而且又要满足实时性，因此模型不能太过复杂，所以模型主要采用速度比较快的LR。但是LR的特征组合能力有限，因此特征工程就特别的重要。现有的特征工程主要集中在特征的重要性以及特征的组合中，采用人力或者单纯的挑选重要性的特征并不可靠，就如同FFM是在FM的基础上增加了"域"的概念，其计算复杂度就增长了很多。而GBDT算法可以用来发掘具有区分度的特征以及相应的特征组合，大大的减少了人力成本。

### Thinking2 Wide &  Deep的模型结构是怎样的，为什么能通过具备记忆和泛化能力（memorization and genera-lization）

##### 1、能简要说明Wide&Deep的模型（5point）:

* wide部分就是一个简单的线性模型，deep部分是一个前馈神经网络模型。将线性模型和前馈神经网络模型合并在一起训练。
  
##### 2、如何具备记忆和泛化能力（5point）

* **“记忆”能力**是指对历史数据集中已经出现过的特征、特征关联及其与label之间关系进行很好的学习。即对**历史数据中已经出现过的模式进行很好的学习**。

  * LR是属于广义线性模型，本身不具备对特征之间非线性关系进行建模。所以通过人工构建特征组合（交叉特征）的方式来给LR模型增加非线性建模能力。特征组合文中的例子如下：

    AND(user_installed_app=netflix, impression_app=pandora"), whose value is 1 if the user installed Netflix and then is later shown Pandora.

    可以看出来人工构建组合特征，主要基于历史数据集中**已经出现过的特征取值组合**，而对于未出现过的特征取值组合**没有办法构建组合特征**。所以LR模型具备很好的记忆能力，但没有泛化能力。

* **“泛化”能力**指能将从历史数据集中学到的模式迁移，用于对包含未出现特征组合的样本进行预测。

  * 深度神经网络模型无需人工构建组合特征，有**自动做特征组合**的能力。而且由于**加入非线性的激活函数**，神经网络模型具备非线性建模能力。神经网络模型的泛化能力除了因为它**<u>自动特征组合的能力</u>**，还因为它对<u>**类别特征的取值做embedding**</u>。这样，由于embedding的特性，即使没出现过的特征取值组合，神经网络模型也可以计算得到组合特征的值。

  

  

### Thinking3 在CTR预估中，使用FM与DNN结合的方式，有哪些结合的方式，代表模型有哪些？

##### 1、能说出哪两种FM和DNN的组合方式（5points）   

* 串行
* 并行

##### 2、能说出FM和DNN的组合出的算法（5points）

* FNN（Factorization-machine supported Neural Networks）：FM进行参数初始化，DNN进行特征训练，串行
  * 注：FNN是有可能是Feedforward Neural Network前馈神经网络
* DeepFM：将Wide&Deep中的Wide替换成FM模型，计算1阶和2阶，Deep依然是DNN，Deep不用FM初始化；并行结构，FM和DNN分开计算
* NFM模型：embedding直接采用对位相乘；串行架构，将FM的结果作为DNN的输入



### Thinking4 GBDT和随机森林都是基于树的算法，它们有什么区别？能简要说明这两种基于树的算法的不同（10points）

* 相同点：都是由多棵树组成，最终的结果都由多棵树共同决定

* 不同点：

  |      |                              RF                              |                             GBDT                             |
  | :--: | :----------------------------------------------------------: | :----------------------------------------------------------: |
  |  1   |                   树可以分类树也可是回归树                   |                        只由回归树组成                        |
  |  2   |                    树并行生成（bagging）                     |                   只能串行生成（boosting）                   |
  |  3   |                       结果是多数表决的                       |                      多棵树加权累加之和                      |
  |  4   |                        对异常值不敏感                        |                       对异常值比较敏感                       |
  |  5   |                     学习目标减少模型方差                     |                    学习目标减少模型的偏差                    |
  |  6   | 不需要特征归一化，通过减少方差提高性能的，树之间建立关系是独立的，不需要归一化 | 需要进行特征归一化，上一颗树的基础上通过梯度下降求解最优解，归一化能收敛的更快 |
  |  7   |                   对训练集一视同仁权值一样                   |                   基于权值的弱分类器的集合                   |

### Thinking5 item流行度在推荐系统中有怎样的应用

1、冷启动中的使用（10points)     

* 就是什么内容吸引用户，就给用户推荐什么内容，新用户在冷启动阶段更倾向于热门排行榜的

2、协同过滤中的TopN推荐（10points）     

* UserCF KNN
* ItemCF KNN
* SVD

3、其他使用（+5points)

​	需要考虑到不同网站的特性

​		•电商网站，比如唯品会特卖，目标是打造爆款

​		•婚恋网站，比如世纪佳缘，目标是让更多人活跃起来

---

---

---





Action1使用Wide&Deep模型对movielens进行评分预测1、完成代码（20points）     2、使用Wide&Deep工具进行评分预测，代码正确（20points）

| 分类           | 内容                                                         | 数据集                                                       | 是否了解掌握 | 评阅点                                                       | GitHub代码 |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------ | ------------------------------------------------------------ | ---------- |
| 课上理解部分   |                                                              |                                                              |              |                                                              |            |
| 原理           | GBDT+LR的原理                                                |                                                              |              |                                                              |            |
| 原理           | Gradient Boosting原理                                        |                                                              |              |                                                              |            |
| 原理           | 使用GBDT进行新特征构造                                       |                                                              |              |                                                              |            |
| 原理           | 评价指标NE，Calibration，AUC                                 |                                                              |              |                                                              |            |
| 原理           | TPRate，FPRate计算                                           |                                                              |              |                                                              |            |
| 工具           | sklearn中的GBDT                                              |                                                              |              |                                                              |            |
| 原理           | Wide & Deep模型                                              |                                                              |              |                                                              |            |
| 原理           | Wide join Deep同时训练                                       |                                                              |              |                                                              |            |
| 工具           | DeepCTR中的WDL                                               |                                                              |              |                                                              |            |
| 原理           | FNN模型                                                      |                                                              |              |                                                              |            |
| 原理           | NFM模型                                                      |                                                              |              |                                                              |            |
| 原理           | FM与DNN的两种结合方式：DeepFM，NFM                           |                                                              |              |                                                              |            |
| 工具           | DeepCTR中的NFM                                               |                                                              |              |                                                              |            |
| 原理           | 基于流行度的推荐算法                                         |                                                              |              |                                                              |            |
| 原理           | 影响流行度的因素                                             |                                                              |              |                                                              |            |
| 原理           | 推荐系统的架构                                               |                                                              |              |                                                              |            |
| 课下思考与练习 |                                                              |                                                              |              |                                                              |            |
| Thinking1      | 在CTR点击率预估中，使用GBDT+LR的原理是什么？                 |                                                              |              | 能简要说明GBDT和LR在CTR预估中的作用（10point）               |            |
| Thinking2      | Wide &  Deep的模型结构是怎样的，为什么能通过具备记忆和泛化能力（memorization and generalization） | 1、能简要说明Wide&Deep的模型（5point）     2、如何具备记忆和泛化能力（5point） |              |                                                              |            |
| Thinking3      | 在CTR预估中，使用FM与DNN结合的方式，有哪些结合的方式，代表模型有哪些？ | 1、能说出哪两种FM和DNN的组合方式（5points）     2、能说出FM和DNN的组合出的算法（5points） |              |                                                              |            |
| Thinking4      | GBDT和随机森林都是基于树的算法，它们有什么区别？             |                                                              |              | 能简要说明这两种基于树的算法的不同（10points）               |            |
| Thinking5      | item流行度在推荐系统中有怎样的应用                           |                                                              |              | 1、冷启动中的使用（10points)     2、协同过滤中的TopN推荐（10points）     3、其他使用（+5points) |            |
| Action1        | 使用Wide&Deep模型对movielens进行评分预测                     |                                                              |              | 1、完成代码（20points）     2、使用Wide&Deep工具进行评分预测，代码正确（20points） |            |